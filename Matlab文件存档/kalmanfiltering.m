Z=1:200;
noise=randn(1,200);
Z=Z+noise;%观测值

X=[0;0];%状态
P=[1,0;0,1];%状态协方差矩阵
F=[1,1;0,1];%状态转移矩阵
Q=[0.0001,0;0,0.0001];%状态转移协方差矩阵
H=[1,0];%观测矩阵
R=1;%观测噪声协方差矩阵

figure(1);

for i=1:200
    X_=F*X;
    P_=F*P*F'+Q;
    K=P_*H'/(H*P_*H'+R);
    X=X_+K*(Z(i)-H*X_);
    P=(eye(2)-K*H)*P_;
    
    scatter(X(1),X(2),'.');
    hold on;
end
